<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Du Yao&#39;s blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="java j2EE spring Mybatis struts2 springMVC">
<meta property="og:type" content="website">
<meta property="og:title" content="Du Yao's blog">
<meta property="og:url" content="http://duyao.github.io/page/3/index.html">
<meta property="og:site_name" content="Du Yao's blog">
<meta property="og:description" content="java j2EE spring Mybatis struts2 springMVC">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Du Yao's blog">
<meta name="twitter:description" content="java j2EE spring Mybatis struts2 springMVC">
  
    <link rel="alternative" href="/atom.xml" title="Du Yao&#39;s blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="null" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">Du Yao</a></h1>
		</hgroup>

		
		<p class="header-subtitle">Make progress step by step</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
							<li><a href="/categories/note">学习笔记</a></li>
				        
							<li><a href="/categories/algorithm">算法学习</a></li>
				        
							<li><a href="/about">关于我</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/duyao" title="github">github</a>
					        
								<a class="mail" target="_blank" href="/duyao_dy@163.com" title="mail">mail</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/Mybatis/" style="font-size: 13.75px;">Mybatis</a> <a href="/tags/algorithm/" style="font-size: 18.75px;">algorithm</a> <a href="/tags/database/" style="font-size: 10px;">database</a> <a href="/tags/git/" style="font-size: 12.5px;">git</a> <a href="/tags/hibernate/" style="font-size: 10px;">hibernate</a> <a href="/tags/jQuery/" style="font-size: 15px;">jQuery</a> <a href="/tags/java/" style="font-size: 16.25px;">java</a> <a href="/tags/jsp/" style="font-size: 10px;">jsp</a> <a href="/tags/leetcode/" style="font-size: 17.5px;">leetcode</a> <a href="/tags/maven/" style="font-size: 10px;">maven</a> <a href="/tags/niuke/" style="font-size: 20px;">niuke</a> <a href="/tags/project/" style="font-size: 11.25px;">project</a> <a href="/tags/spring/" style="font-size: 15px;">spring</a> <a href="/tags/springMVC/" style="font-size: 10px;">springMVC</a> <a href="/tags/words/" style="font-size: 10px;">words</a> <a href="/tags/快捷键/" style="font-size: 10px;">快捷键</a> <a href="/tags/设计模式/" style="font-size: 10px;">设计模式</a>
					</div>
				</section>
				
				
				

				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">Du Yao</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="null" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">Du Yao</h1>
			</hgroup>
			
			<p class="header-subtitle">Make progress step by step</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
					<li><a href="/categories/note">学习笔记</a></li>
		        
					<li><a href="/categories/algorithm">算法学习</a></li>
		        
					<li><a href="/about">关于我</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/duyao" title="github">github</a>
			        
						<a class="mail" target="_blank" href="/duyao_dy@163.com" title="mail">mail</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap">
  
    <article id="post-78-Subsets" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/04/04/78-Subsets/" class="article-date">
  	<time datetime="2016-04-04T06:18:10.000Z" itemprop="datePublished">2016-04-04</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/04/78-Subsets/">78. Subsets</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      

      <!-- Table of Contents -->
        
        <p><a href="https://leetcode.com/problems/subsets/" target="_blank" rel="external">78. Subsets</a><br>相似问题<a href="https://leetcode.com/problems/permutations/" target="_blank" rel="external">46. Permutations</a><br>题解<a href="http://duyao.github.io/2016/02/18/46-Permutations/">46 Answer</a></p>
<h2 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h2><h3 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h3><p>利用bitmap<br>所给数组是a[n]，则所有的方法总数是2^n的个数<br>所有的组合形式是0-2^n-1的二进制数</p>
<p>&gt;<br>Number of subsets for {1 , 2 , 3 } = 2^3 . why ?<br>case    possible outcomes for the set of subsets<br>  1   -&gt;          Take or dont take = 2<br>  2   -&gt;          Take or dont take = 2<br>  3   -&gt;          Take or dont take = 2<br>therefore , total = 2<em>2</em>2 = 2^3 = { { } , {1} , {2} , {3} , {1,2} , {1,3} , {2,3} , {1,2,3} }<br>Lets assign bits to each outcome  -&gt; First bit to 1 , Second bit to 2 and third bit to 3<br>Take = 1<br>Dont take = 0<br>0) 0 0 0  -&gt; Dont take 3 , Dont take 2 , Dont take 1 = { }<br>1) 0 0 1  -&gt; Dont take 3 , Dont take 2 ,   take 1       =  {1 }<br>2) 0 1 0  -&gt; Dont take 3 ,    take 2       , Dont take 1 = { 2 }<br>3) 0 1 1  -&gt; Dont take 3 ,    take 2       ,      take 1    = { 1 , 2 }<br>4) 1 0 0  -&gt;    take 3      , Dont take 2  , Dont take 1 = { 3 }<br>5) 1 0 1  -&gt;    take 3      , Dont take 2  ,     take 1     = { 1 , 3 }<br>6) 1 1 0  -&gt;    take 3      ,    take 2       , Dont take 1 = { 2 , 3 }<br>7) 1 1 1  -&gt;    take 3     ,      take 2     ,      take 1     = { 1 , 2 , 3 }<br>In the above logic ,Insert S[i] only if (j&gt;&gt;i)&amp;1 ==true   { j E { 0,1,2,3,4,5,6,7 }   i = ith element in the input array }<br>element 1 is inserted only into those places where 1st bit of j is 1<br>   if( j &gt;&gt; 0 &amp;1 )  ==&gt; for above above eg. this is true for sl.no.( j )= 1 , 3 , 5 , 7<br>element 2 is inserted only into those places where 2nd bit of j is 1<br>   if( j &gt;&gt; 1 &amp;1 )  == for above above eg. this is true for sl.no.( j ) = 2 , 3 , 6 , 7<br>element 3 is inserted only into those places where 3rd bit of j is 1<br>   if( j &gt;&gt; 2 &amp; 1 )  == for above above eg. this is true for sl.no.( j ) = 4 , 5 , 6 , 7<br>Time complexity : O(n*2^n) , for every input element loop traverses the whole solution set length i.e. 2^n</p>
<p>reference:<a href="https://leetcode.com/discuss/9213/my-solution-using-bit-manipulation" target="_blank" rel="external">bitmap solution</a></p>
<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight dart"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">public <span class="built_in">List</span>&lt;<span class="built_in">List</span>&lt;Integer&gt;&gt; subsets(<span class="built_in">int</span>[] S) &#123;</div><div class="line">    Arrays.sort(S);</div><div class="line">    <span class="comment">//所有的结果数是2^n</span></div><div class="line">    <span class="comment">//&lt;&lt;是左移</span></div><div class="line">    <span class="built_in">int</span> totalNumber = <span class="number">1</span> &lt;&lt; S.length;</div><div class="line">    <span class="built_in">List</span>&lt;<span class="built_in">List</span>&lt;Integer&gt;&gt; collection = <span class="keyword">new</span> ArrayList&lt;<span class="built_in">List</span>&lt;Integer&gt;&gt;(totalNumber);</div><div class="line">    <span class="comment">//结果所有数字的二进制表示</span></div><div class="line">    <span class="keyword">for</span> (<span class="built_in">int</span> i=<span class="number">0</span>; i&lt;totalNumber; i++) &#123;</div><div class="line">        <span class="built_in">List</span>&lt;Integer&gt; <span class="keyword">set</span> = <span class="keyword">new</span> LinkedList&lt;Integer&gt;();</div><div class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> j=<span class="number">0</span>; j&lt;S.length; j++) &#123;</div><div class="line">	        <span class="comment">//System.out.println("i="+i+",j="+j+",i &amp; 1&lt;&lt;j="+(i &amp; (1&lt;&lt;j)));</span></div><div class="line">            <span class="comment">//对于每个i都把其二进制中的1添加进来</span></div><div class="line">        	<span class="comment">//因此把1不停的左移，就用&amp;能筛选出所有的</span></div><div class="line">        	<span class="keyword">if</span> ((i &amp; (<span class="number">1</span>&lt;&lt;j)) != <span class="number">0</span>) &#123;</div><div class="line">                <span class="keyword">set</span>.add(S[j]);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        collection.add(<span class="keyword">set</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> collection;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h2><h3 id="思路-1"><a href="#思路-1" class="headerlink" title="思路"></a>思路</h3><p>递归遍历，有点像dfs</p>
<p>subsets = {1 , 2 , 3 }<br>添加顺序为<br>{}<br>{1}<br>{1,2}<br>{1,2,3}<br>{1,3}//path.remove(path.size() - 1),此时i=3,退回i=2,添加3<br>{2}<br>{2,3}<br>{3}</p>
<h3 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h3><figure class="highlight zephir"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">List</span>&lt;<span class="keyword">List</span>&lt;Integer&gt;&gt; subsets(<span class="keyword">int</span>[] nums) &#123;</div><div class="line"></div><div class="line">	<span class="keyword">List</span>&lt;<span class="keyword">List</span>&lt;Integer&gt;&gt; res = <span class="keyword">new</span> ArrayList&lt;<span class="keyword">List</span>&lt;Integer&gt;&gt;();</div><div class="line">	res.add(<span class="keyword">new</span> ArrayList&lt;Integer&gt;());</div><div class="line">	<span class="comment">//添加时保证有序</span></div><div class="line">	Arrays.sort(nums);</div><div class="line">	f(nums, <span class="number">0</span>, <span class="keyword">new</span> ArrayList&lt;Integer&gt;(), res);</div><div class="line">	<span class="keyword">return</span> res;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">public</span> void f(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> index, <span class="keyword">List</span>&lt;Integer&gt; path,</div><div class="line">		<span class="keyword">List</span>&lt;<span class="keyword">List</span>&lt;Integer&gt;&gt; res) &#123;</div><div class="line">	</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = index; i &lt; nums.length; i++) &#123;</div><div class="line">		path.add(nums[i]);</div><div class="line">		<span class="comment">//这里添加一定要new一个，不然后面path删除元素会影响结果集</span></div><div class="line">		<span class="comment">//res.add(path);</span></div><div class="line">		res.add(<span class="keyword">new</span> ArrayList&lt;Integer&gt;(path));</div><div class="line">		f(nums, i + <span class="number">1</span>, path, res);</div><div class="line">		path.remove(path.size() - <span class="number">1</span>);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="方法三"><a href="#方法三" class="headerlink" title="方法三"></a>方法三</h2><h3 id="思路-2"><a href="#思路-2" class="headerlink" title="思路"></a>思路</h3><p>循环遍历</p>
<ol>
<li>在结果集中添加一个空元素</li>
<li>遍历每个数字<br>2.1 ，遍历所有结果集中的结果,将这个数字添加到每个结果中<br>2.2 更新结果集</li>
</ol>
<p>subsets = {1 , 2 , 3 }<br>添加顺序为<br>{} //add empty<br>{1} // add 1to {}, add 1 for ends<br>{2} //add to {},{1}<br>{1,2} //add 2 for ends<br>{3} // add 3 to {}, {1}, {2}, {1,2}<br>{1,3}<br>{2,3}<br>{1,2,3} //add 3 for ends</p>
<h3 id="代码-2"><a href="#代码-2" class="headerlink" title="代码"></a>代码</h3><ul>
<li>错误一</li>
</ul>
<p>java.util.ConcurrentModificationException<br><figure class="highlight lasso"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">for (<span class="built_in">Integer</span> i : nums) &#123;</div><div class="line">	<span class="comment">// java.util.ConcurrentModificationException</span></div><div class="line">	<span class="built_in">List</span>&lt;<span class="built_in">List</span>&lt;<span class="built_in">Integer</span>&gt;&gt; tmp = <span class="literal">new</span> ArrayList&lt;<span class="built_in">List</span>&lt;<span class="built_in">Integer</span>&gt;&gt;(res);</div><div class="line">	for (<span class="built_in">List</span>&lt;<span class="built_in">Integer</span>&gt; sub : tmp) &#123;</div><div class="line">		<span class="built_in">List</span>&lt;<span class="built_in">Integer</span>&gt; tt = <span class="literal">new</span> ArrayList&lt;<span class="built_in">Integer</span>&gt;(sub);</div><div class="line">		tt.add(i);</div><div class="line">		tmp.add(tt);</div><div class="line">	&#125;</div><div class="line">	res = tmp;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<ul>
<li>错误二</li>
</ul>
<p>添加关联影响<br><figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (Integer i : nums) &#123;</div><div class="line">	List&lt;List&lt;Integer&gt;&gt; tmp = new ArrayList&lt;List&lt;Integer&gt;&gt;();</div><div class="line">	<span class="keyword">for</span> (List&lt;Integer&gt; <span class="function"><span class="keyword">sub</span> : <span class="title">res</span>) </span>&#123;</div><div class="line">		//这里<span class="function"><span class="keyword">sub</span>添加后，<span class="title">res</span>会马上改变</span></div><div class="line">		<span class="title">sub</span>.<span class="title">add</span>(i);</div><div class="line">		tmp.add(<span class="function"><span class="keyword">sub</span>)</span>;</div><div class="line">	&#125;</div><div class="line">	res.addAll(tmp);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<ul>
<li>正确代码</li>
</ul>
<figure class="highlight zephir"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">List</span>&lt;<span class="keyword">List</span>&lt;Integer&gt;&gt; subsets1(<span class="keyword">int</span>[] nums)&#123;</div><div class="line">	<span class="keyword">List</span>&lt;<span class="keyword">List</span>&lt;Integer&gt;&gt; res = <span class="keyword">new</span> ArrayList&lt;<span class="keyword">List</span>&lt;Integer&gt;&gt;();</div><div class="line">	res.add(<span class="keyword">new</span> ArrayList&lt;Integer&gt;());</div><div class="line">	Arrays.sort(nums);</div><div class="line">	<span class="keyword">for</span> (Integer i : nums) &#123;			</div><div class="line">		<span class="comment">//记录本次循环添加的list,一定与res无关，不然ConcurrentModificationException</span></div><div class="line">		<span class="keyword">List</span>&lt;<span class="keyword">List</span>&lt;Integer&gt;&gt; tmp = <span class="keyword">new</span> ArrayList&lt;<span class="keyword">List</span>&lt;Integer&gt;&gt;();</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">List</span>&lt;Integer&gt; sub : res) &#123;</div><div class="line">			<span class="comment">//对于sub建立副本，不然修改sub，res会改变</span></div><div class="line">			<span class="keyword">List</span>&lt;Integer&gt; <span class="keyword">list</span> = <span class="keyword">new</span> ArrayList&lt;Integer&gt;(sub);</div><div class="line">			<span class="keyword">list</span>.add(i);</div><div class="line">			tmp.add(<span class="keyword">list</span>);</div><div class="line">		&#125;</div><div class="line">		<span class="comment">//同步回res</span></div><div class="line">		res.addAll(tmp);		</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> res;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/algorithm/">algorithm</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/leetcode/">leetcode</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-93-Restore-IP-Addresses" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/04/01/93-Restore-IP-Addresses/" class="article-date">
  	<time datetime="2016-04-01T13:22:22.000Z" itemprop="datePublished">2016-04-01</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/01/93-Restore-IP-Addresses/">93. Restore IP Addresses</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      

      <!-- Table of Contents -->
        
        <p><a href="https://leetcode.com/problems/restore-ip-addresses/" target="_blank" rel="external">93. Restore IP Addresses</a></p>
<p>Backtracking - 回溯</p>
<figure class="highlight lasso"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="built_in">List</span>&lt;<span class="built_in">String</span>&gt; restoreIpAddresses(<span class="built_in">String</span> s) &#123;</div><div class="line">	<span class="built_in">List</span>&lt;<span class="built_in">String</span>&gt; <span class="built_in">list</span> = <span class="literal">new</span> ArrayList&lt;<span class="built_in">String</span>&gt;();</div><div class="line">	<span class="keyword">if</span>(s == <span class="built_in">null</span> || s.length() &lt; <span class="number">4</span>)&#123;</div><div class="line">		<span class="keyword">return</span> <span class="built_in">list</span>;</div><div class="line">	&#125;</div><div class="line">	for(int i = <span class="number">1</span>; i &lt; <span class="number">4</span>;i++)&#123;</div><div class="line">		<span class="built_in">String</span> s1 = s.substring(<span class="number">0</span>, i);</div><div class="line">		<span class="comment">//注意判断是否超出数组长度，且每次循环前判断是否合法，这样能减少后面无用的判断</span></div><div class="line">		for(int j = <span class="number">1</span>; isVaild(s1) &amp;&amp; j &lt; <span class="number">4</span> &amp;&amp; i+j &lt; s.length();j++)&#123;</div><div class="line">			<span class="built_in">String</span> s2 = s.substring(i, i+j);</div><div class="line">			for(int k = <span class="number">1</span>; isVaild(s2) &amp;&amp; k &lt; <span class="number">4</span> &amp;&amp; i+j+k &lt; s.length(); k++)&#123;</div><div class="line">				<span class="built_in">String</span> s3 = s.substring(i+j, i+j+k);</div><div class="line">				<span class="built_in">String</span> s4 = s.substring(i+j+k, s.length());</div><div class="line">				<span class="keyword">if</span>(isVaild(s3) &amp;&amp; isVaild(s4))&#123;</div><div class="line">					<span class="built_in">list</span>.add(s1+<span class="string">"."</span>+s2+<span class="string">"."</span>+s3+<span class="string">"."</span>+s4);</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="built_in">list</span>;</div><div class="line">&#125;</div><div class="line"><span class="keyword">public</span> <span class="built_in">boolean</span> isVaild(<span class="built_in">String</span> s)&#123;</div><div class="line">	<span class="keyword">if</span>(s.length() == <span class="number">1</span>)&#123;</div><div class="line">		<span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">	&#125;<span class="keyword">else</span> <span class="keyword">if</span>(s.length() == <span class="number">2</span> &amp;&amp; s.charAt(<span class="number">0</span>) != <span class="string">'0'</span>)&#123;</div><div class="line">		<span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">	&#125;<span class="keyword">else</span> <span class="keyword">if</span>(s.length() == <span class="number">3</span> &amp;&amp; s.charAt(<span class="number">0</span>) != <span class="string">'0'</span> &amp;&amp; <span class="built_in">Integer</span>.valueOf(s) &lt; <span class="number">256</span>)&#123;</div><div class="line">		<span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">	&#125;<span class="keyword">else</span>&#123;</div><div class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/algorithm/">algorithm</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/leetcode/">leetcode</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-15-3Sum" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/04/01/15-3Sum/" class="article-date">
  	<time datetime="2016-04-01T11:54:26.000Z" itemprop="datePublished">2016-04-01</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/01/15-3Sum/">15. 3Sum</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      

      <!-- Table of Contents -->
        
        <p><a href="https://leetcode.com/problems/3sum/" target="_blank" rel="external">15. 3Sum</a><br><a href="http://duyao.github.io/2016/03/27/1-Two-Sum/">Two sum</a>的进阶</p>
<h2 id="思路一"><a href="#思路一" class="headerlink" title="思路一"></a>思路一</h2><p>利用HashMap存储另外两个数字的和，然后遍历数组类似于Two sum的思路<br>但是3重循环，超时<br><figure class="highlight processing"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; threeSum(<span class="built_in">int</span>[] nums) &#123;</div><div class="line"></div><div class="line">	<span class="keyword">if</span> (nums == <span class="keyword">null</span> || nums.length &lt; <span class="number">3</span>) &#123;</div><div class="line">		<span class="keyword">return</span> <span class="keyword">new</span> ArrayList&lt;List&lt;Integer&gt;&gt;();</div><div class="line">	&#125;</div><div class="line">	Arrays.<span class="built_in">sort</span>(nums);</div><div class="line">	Set&lt;List&lt;Integer&gt;&gt; res = <span class="keyword">new</span> HashSet&lt;List&lt;Integer&gt;&gt;();</div><div class="line">	<span class="comment">// 3层循环,o(n^3)超时</span></div><div class="line">	<span class="keyword">for</span> (<span class="built_in">int</span> k = <span class="number">0</span>; k &lt; nums.length; k++) &#123;</div><div class="line">		<span class="keyword">HashMap</span>&lt;Integer, List&lt;Integer&gt;&gt; <span class="built_in">map</span> = <span class="keyword">new</span> <span class="keyword">HashMap</span>&lt;Integer, List&lt;Integer&gt;&gt;();</div><div class="line"></div><div class="line">		<span class="keyword">for</span> (<span class="built_in">int</span> i = k + <span class="number">1</span>; i &lt; nums.length; i++) &#123;</div><div class="line">			<span class="keyword">if</span> (i == k + <span class="number">1</span> || nums[i] != nums[i - <span class="number">1</span>]) &#123;</div><div class="line">				<span class="keyword">for</span> (<span class="built_in">int</span> j = i + <span class="number">1</span>; j &lt; nums.length; j++) &#123;</div><div class="line">					<span class="keyword">if</span> (j == i + <span class="number">1</span> || nums[j] != nums[j - <span class="number">1</span>]) &#123;</div><div class="line">						<span class="built_in">int</span> tmp = nums[i] + nums[j];</div><div class="line">						<span class="keyword">if</span> (!<span class="built_in">map</span>.containsKey(tmp)) &#123;</div><div class="line">							<span class="built_in">map</span>.put(tmp, <span class="keyword">new</span> ArrayList&lt;Integer&gt;());</div><div class="line">						&#125;</div><div class="line">						List&lt;Integer&gt; list = <span class="built_in">map</span>.<span class="built_in">get</span>(tmp);</div><div class="line">						list.<span class="built_in">add</span>(nums[i]);</div><div class="line">						list.<span class="built_in">add</span>(nums[j]);</div><div class="line">					&#125;</div><div class="line">				&#125;</div><div class="line"></div><div class="line">			&#125;</div><div class="line"></div><div class="line">		&#125;</div><div class="line">		<span class="comment">//</span></div><div class="line">		<span class="keyword">if</span> (<span class="built_in">map</span>.containsKey(-nums[k])) &#123;</div><div class="line">			List&lt;Integer&gt; tmp = <span class="built_in">map</span>.<span class="built_in">get</span>(-nums[k]);</div><div class="line">			<span class="keyword">for</span> (<span class="built_in">int</span> j = <span class="number">0</span>; j &lt; tmp.<span class="built_in">size</span>(); j += <span class="number">2</span>) &#123;</div><div class="line">				List&lt;Integer&gt; list = <span class="keyword">new</span> ArrayList&lt;Integer&gt;();</div><div class="line">				<span class="built_in">int</span> s = Math.<span class="built_in">min</span>(tmp.<span class="built_in">get</span>(j), tmp.<span class="built_in">get</span>(j + <span class="number">1</span>));</div><div class="line">				<span class="built_in">int</span> b = tmp.<span class="built_in">get</span>(j) == s ? tmp.<span class="built_in">get</span>(j + <span class="number">1</span>) : tmp.<span class="built_in">get</span>(j);</div><div class="line">				<span class="keyword">if</span> (s &gt; nums[k]) &#123;</div><div class="line">					list.<span class="built_in">add</span>(nums[k]);</div><div class="line">					list.<span class="built_in">add</span>(s);</div><div class="line">					list.<span class="built_in">add</span>(b);</div><div class="line">				&#125; <span class="keyword">else</span> &#123;</div><div class="line">					list.<span class="built_in">add</span>(s);</div><div class="line">					<span class="keyword">if</span> (b &gt; nums[k]) &#123;</div><div class="line">						list.<span class="built_in">add</span>(nums[k]);</div><div class="line">						list.<span class="built_in">add</span>(b);</div><div class="line">					&#125; <span class="keyword">else</span> &#123;</div><div class="line">						list.<span class="built_in">add</span>(b);</div><div class="line">						list.<span class="built_in">add</span>(nums[k]);</div><div class="line">					&#125;</div><div class="line"></div><div class="line">				&#125;</div><div class="line">				res.<span class="built_in">add</span>(list);</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line"></div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="keyword">return</span> <span class="keyword">new</span> ArrayList&lt;List&lt;Integer&gt;&gt;(res);</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="思路二"><a href="#思路二" class="headerlink" title="思路二"></a>思路二</h2><p>先排序，从头开始遍历，从剩余的数字中利用两指针找和是其相反数的的两个数字<br>这么做是因为数组有序，时间复杂度o(n<em>n</em>logN)<br>加入队列判断重复是利用<code>Set&lt;List&lt;Integer&gt;&gt;</code></p>
<figure class="highlight zephir"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">List</span>&lt;<span class="keyword">List</span>&lt;Integer&gt;&gt; threeSum(<span class="keyword">int</span>[] nums) &#123;</div><div class="line">	Arrays.sort(nums);</div><div class="line">	Set&lt;<span class="keyword">List</span>&lt;Integer&gt;&gt; res = <span class="keyword">new</span> HashSet&lt;<span class="keyword">List</span>&lt;Integer&gt;&gt;();</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length; i++)&#123;</div><div class="line">		<span class="keyword">int</span> low = i + <span class="number">1</span>;</div><div class="line">		<span class="keyword">int</span> high = nums.length - <span class="number">1</span>;</div><div class="line">		<span class="keyword">while</span>(low &lt; high)&#123;</div><div class="line">			<span class="keyword">if</span>(nums[low] + nums[high] &lt; -nums[i])&#123;</div><div class="line">				low++;</div><div class="line">			&#125;<span class="keyword">else</span> <span class="keyword">if</span>(nums[low] + nums[high] &gt; -nums[i])&#123;</div><div class="line">				high--;</div><div class="line">			&#125;<span class="keyword">else</span>&#123;</div><div class="line">				<span class="keyword">List</span>&lt;Integer&gt; <span class="keyword">list</span> = <span class="keyword">new</span> ArrayList&lt;Integer&gt;();</div><div class="line">				<span class="keyword">list</span>.add(nums[i]);</div><div class="line">				<span class="keyword">list</span>.add(nums[low]);</div><div class="line">				<span class="keyword">list</span>.add(nums[high]);</div><div class="line">				res.add(<span class="keyword">list</span>);</div><div class="line">				low++;</div><div class="line">				high--;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="keyword">new</span> ArrayList&lt;<span class="keyword">List</span>&lt;Integer&gt;&gt;(res);</div><div class="line">&#125;</div></pre></td></tr></table></figure>


      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/algorithm/">algorithm</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/leetcode/">leetcode</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-素数筛法及优化" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/28/素数筛法及优化/" class="article-date">
  	<time datetime="2016-03-28T13:54:43.000Z" itemprop="datePublished">2016-03-28</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/28/素数筛法及优化/">素数筛法及优化</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      

      <!-- Table of Contents -->
        
        <h2 id="普通素数筛法"><a href="#普通素数筛法" class="headerlink" title="普通素数筛法"></a>普通素数筛法</h2><figure class="highlight processing"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//bitset 被置1说明是素数</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> count(BitSet <span class="built_in">set</span>)&#123;</div><div class="line">	<span class="comment">//length() -&gt; Returns the "logical size" of this BitSet</span></div><div class="line">	<span class="keyword">for</span>(<span class="built_in">int</span> i = <span class="number">2</span>; i &lt; <span class="built_in">set</span>.<span class="built_in">size</span>(); i++)&#123;</div><div class="line">		<span class="comment">//初始化，全部置1</span></div><div class="line">		<span class="built_in">set</span>.<span class="built_in">set</span>(i);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">for</span>(<span class="built_in">int</span> i = <span class="number">2</span>; i * i &lt; <span class="built_in">set</span>.<span class="built_in">size</span>(); i++)&#123;</div><div class="line">		<span class="keyword">if</span>(<span class="built_in">set</span>.<span class="built_in">get</span>(i))&#123;</div><div class="line">			<span class="keyword">for</span>(<span class="built_in">int</span> j = <span class="number">2</span> * i; j &lt; <span class="built_in">set</span>.length(); j += i)&#123;</div><div class="line">				<span class="comment">//素数的倍数全部标记为非素数</span></div><div class="line">				<span class="built_in">set</span>.<span class="built_in">clear</span>(j);</div><div class="line">				</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="线性素数筛法"><a href="#线性素数筛法" class="headerlink" title="线性素数筛法"></a>线性素数筛法</h2><p>上面的筛选方法中，可以看出，有很多重复<br>比如30，会被2,3,5都标记，这样重复很多次<br>下面的方法所有数字只会被标记一次，是线性的</p>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">	<span class="keyword">final</span> <span class="keyword">int</span> N = <span class="number">100000</span>;</div><div class="line">	<span class="keyword">boolean</span>[] isNot = <span class="keyword">new</span> <span class="keyword">boolean</span>[N];</div><div class="line">	<span class="keyword">int</span>[] prime = <span class="keyword">new</span> <span class="keyword">int</span>[N];</div><div class="line">	<span class="keyword">int</span> cnt = <span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; N; i++)&#123;</div><div class="line">		<span class="keyword">if</span>(!isNot[i])&#123;</div><div class="line">			prime[cnt++] = i;</div><div class="line">		&#125;</div><div class="line">		<span class="comment">//1.每个数字都会经过这循环</span></div><div class="line">		<span class="comment">//a.如果是素数，就标记素数的素数倍数，即k=p1*p2，而p1,p2都是不相同的素数，一定不会重复筛选</span></div><div class="line">		<span class="comment">//b.如果是合数，就只晒出该数字和最小素数的乘积，这样筛选才不会重复。</span></div><div class="line">		<span class="comment">//因为一个合数是若干素数的乘积，因为筛选过程不重复，因此只会被最小素数和另一数字乘积时选住</span></div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; cnt &amp;&amp; prime[j] * i &lt; N; j++)&#123;</div><div class="line">			isNot[i * prime[j]] = <span class="keyword">true</span>;</div><div class="line">		<span class="comment">//	System.out.println("i * prime[j] = "+i+"*"+prime[j]+" = "+i * prime[j]);</span></div><div class="line">			<span class="comment">//2.该合数是素数的倍数就退出筛选</span></div><div class="line">			<span class="keyword">if</span>(i%prime[j] == <span class="number">0</span>)&#123;</div><div class="line">				<span class="keyword">break</span>;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>关键之处在于2，保证了每个数字筛选一次，因为只会被其最小的素数因子筛选到！<br>这里所有合数都可以表示成若干个素数的乘积</p>


      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/algorithm/">algorithm</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-1-Two-Sum" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/27/1-Two-Sum/" class="article-date">
  	<time datetime="2016-03-27T09:16:36.000Z" itemprop="datePublished">2016-03-27</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/27/1-Two-Sum/">1. Two Sum</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      

      <!-- Table of Contents -->
        
        <p><a href="https://leetcode.com/problems/two-sum/" target="_blank" rel="external">1. Two Sum</a></p>
<figure class="highlight processing"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="built_in">int</span>[] twoSum(<span class="built_in">int</span>[] nums, <span class="built_in">int</span> target) &#123;</div><div class="line">	<span class="keyword">HashMap</span>&lt;Integer, Integer&gt; <span class="built_in">map</span> = <span class="keyword">new</span> <span class="keyword">HashMap</span>&lt;Integer, Integer&gt;();</div><div class="line">	</div><div class="line">	<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; nums.length; i++) &#123;</div><div class="line">		<span class="keyword">if</span>(<span class="built_in">map</span>.containsKey(target - nums[i]))&#123;</div><div class="line">			<span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">int</span>[]&#123;target - nums[i],i&#125;;</div><div class="line">		&#125;<span class="keyword">else</span>&#123;</div><div class="line">			<span class="built_in">map</span>.put(nums[i], i);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>注意不是有序表，用两个指针不管用，本题目如果硬是凑出了有序表，时间复杂度变为O(nlog(n))</p>


      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/algorithm/">algorithm</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/leetcode/">leetcode</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-230-Kth-Smallest-Element-in-a-BST" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/26/230-Kth-Smallest-Element-in-a-BST/" class="article-date">
  	<time datetime="2016-03-26T14:58:58.000Z" itemprop="datePublished">2016-03-26</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/26/230-Kth-Smallest-Element-in-a-BST/">230. Kth Smallest Element in a BST</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      

      <!-- Table of Contents -->
        
        <p><a href="https://leetcode.com/problems/kth-smallest-element-in-a-bst/" target="_blank" rel="external">230. Kth Smallest Element in a BST</a></p>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">int</span> <span class="title">kthSmallest</span><span class="params">(TreeNode root, <span class="keyword">int</span> k)</span> </span>&#123;</div><div class="line">	<span class="keyword">int</span> cnt = vis(root.left);</div><div class="line">	<span class="keyword">if</span>(k == cnt+<span class="number">1</span>)&#123;</div><div class="line">		<span class="keyword">return</span> root.val;</div><div class="line">	&#125;<span class="function"><span class="keyword">else</span> <span class="title">if</span><span class="params">(k &lt; cnt+<span class="number">1</span>)</span></span>&#123;</div><div class="line">		从左子树找</div><div class="line">		<span class="function"><span class="keyword">return</span> <span class="title">kthSmallest</span><span class="params">(root.left, k)</span></span>;</div><div class="line">	&#125;<span class="keyword">else</span>&#123;</div><div class="line">		<span class="comment">//从右子树找</span></div><div class="line">		<span class="function"><span class="keyword">return</span> <span class="title">kthSmallest</span><span class="params">(root.right, k - cnt - <span class="number">1</span>)</span></span>;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//计算节点个数</span></div><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">int</span> <span class="title">vis</span><span class="params">(TreeNode root)</span> </span>&#123;</div><div class="line">	<span class="keyword">if</span> (root == <span class="keyword">null</span>) &#123;</div><div class="line">		<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> vis(root.left) + vis(root.right) + <span class="number">1</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/algorithm/">algorithm</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/leetcode/">leetcode</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-130-Surrounded-Regions" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/26/130-Surrounded-Regions/" class="article-date">
  	<time datetime="2016-03-26T11:52:13.000Z" itemprop="datePublished">2016-03-26</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/26/130-Surrounded-Regions/">130. Surrounded Regions</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      

      <!-- Table of Contents -->
        
        <p><a href="https://leetcode.com/problems/surrounded-regions/" target="_blank" rel="external">130. Surrounded Regions</a></p>
<h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><p>是图的遍历，类似于岛屿的个数<br>但是边缘的全部不能被该成X<br>因此可以先遍历所有边缘的O，即把本身和与其相连的O全部变为b</p>
<p>然后再顺序遍历，将b变为O，将O变为X</p>
<p><strong>注意</strong><br>bfs遍历时，访问元素可以是入队也可以是出队</p>
<ul>
<li>入队</li>
</ul>
<p>如果不设置入队判断，必须是入队访问，即入队是将O变为b<br>因为元素可能会重复入内</p>
<ul>
<li>出队</li>
</ul>
<p>出队访问的话，有可能会导致元素重复入队，造成死循环，因此设置是否入队标志</p>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">static</span> <span class="keyword">class</span> <span class="title">Node</span>&#123;</div><div class="line">	<span class="keyword">int</span> x;</div><div class="line">	<span class="keyword">int</span> y;</div><div class="line">	<span class="comment">//记录坐标信息，不需要设置访问值，因为被访问后的值会被改变</span></div><div class="line">	Node(<span class="keyword">int</span> x, <span class="keyword">int</span> y)&#123;</div><div class="line">		<span class="keyword">this</span>.x = x;</div><div class="line">		<span class="keyword">this</span>.y = y;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">//只访问边界的坐标，将边界坐标o置为b，且其相邻的o也遍历置为b</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">bfsBoundary</span>(<span class="params"><span class="keyword">char</span>[][] c, <span class="keyword">int</span> x, <span class="keyword">int</span> y,boolean[][] <span class="keyword">in</span></span>)</span>&#123;</div><div class="line">	<span class="keyword">int</span> len = c[<span class="number">0</span>].length;</div><div class="line">	<span class="keyword">int</span> wid = c.length;</div><div class="line">	<span class="keyword">int</span>[] xx = &#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">-1</span>&#125;;</div><div class="line">	<span class="keyword">int</span>[] yy = &#123;<span class="number">-1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>&#125;;</div><div class="line">	</div><div class="line">	LinkedList&lt;Node&gt; queue = <span class="keyword">new</span> LinkedList&lt;Node&gt;();</div><div class="line">	queue.<span class="keyword">add</span>(<span class="keyword">new</span> Node(x, y));</div><div class="line">	c[x][y] = <span class="string">'b'</span>;</div><div class="line"><span class="comment">//	in[x][y] =true;</span></div><div class="line">	<span class="keyword">while</span>(!queue.isEmpty())&#123;</div><div class="line">		Node cur = queue.poll();</div><div class="line"><span class="comment">//		c[cur.x][cur.y] = 'b';</span></div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; xx.length; i++)&#123;</div><div class="line">			<span class="keyword">int</span> curX = cur.x + xx[i];</div><div class="line">			<span class="keyword">int</span> curY = cur.y + yy[i];</div><div class="line"><span class="comment">//			&amp;&amp; !in[curX][curY]</span></div><div class="line">			<span class="keyword">if</span>( curX &gt;= <span class="number">0</span> &amp;&amp; curX &lt; wid &amp;&amp; curY &gt;= <span class="number">0</span> &amp;&amp; curY &lt; len &amp;&amp; c[curX][curY] == <span class="string">'O'</span> )&#123;</div><div class="line">				queue.<span class="keyword">add</span>(<span class="keyword">new</span> Node(curX, curY));</div><div class="line"><span class="comment">//				in[curX][curY] = true;</span></div><div class="line">				c[curX][curY] = <span class="string">'b'</span>;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">solve</span>(<span class="params"><span class="keyword">char</span>[][] board</span>) </span>&#123;</div><div class="line"></div><div class="line">	<span class="keyword">if</span>(board == <span class="literal">null</span> || board.length == <span class="number">0</span>)&#123;</div><div class="line">		<span class="keyword">return</span>;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	boolean[][] <span class="keyword">in</span> = <span class="keyword">new</span> boolean[board.length][board[<span class="number">0</span>].length];</div><div class="line">	<span class="keyword">int</span> len = board[<span class="number">0</span>].length;</div><div class="line">	<span class="keyword">int</span> wid = board.length;</div><div class="line">	<span class="comment">//访问边缘</span></div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;len; i++)&#123;</div><div class="line">		<span class="keyword">if</span>(board[<span class="number">0</span>][i] == <span class="string">'O'</span>)&#123;</div><div class="line">			bfsBoundary(board, <span class="number">0</span>, i, <span class="keyword">in</span>);</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span>(board[wid<span class="number">-1</span>][i] == <span class="string">'O'</span>)&#123;</div><div class="line">			bfsBoundary(board, wid<span class="number">-1</span>, i, <span class="keyword">in</span>);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; wid; i++)&#123;</div><div class="line">		<span class="keyword">if</span>(board[i][<span class="number">0</span>] == <span class="string">'O'</span>)&#123;</div><div class="line">			bfsBoundary(board, i, <span class="number">0</span>, <span class="keyword">in</span>);</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span>(board[i][len<span class="number">-1</span>] == <span class="string">'O'</span>)&#123;</div><div class="line">			bfsBoundary(board, i, len<span class="number">-1</span>, <span class="keyword">in</span>);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="comment">//顺序访问</span></div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; wid; i++)&#123;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; len; j++)&#123;</div><div class="line">			<span class="keyword">if</span>(board[i][j] == <span class="string">'b'</span>)&#123;</div><div class="line">				board[i][j] = <span class="string">'O'</span>;</div><div class="line">			&#125;</div><div class="line">			<span class="function"><span class="keyword">else</span> <span class="title">if</span>(<span class="params">board[i][j] == <span class="string">'O'</span></span>)</span>&#123;</div><div class="line">				board[i][j] = <span class="string">'X'</span>;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>


      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/algorithm/">algorithm</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/leetcode/">leetcode</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-Callable-and-Future" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/26/Callable-and-Future/" class="article-date">
  	<time datetime="2016-03-26T07:08:55.000Z" itemprop="datePublished">2016-03-26</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/26/Callable-and-Future/">Callable and Future</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      

      <!-- Table of Contents -->
        
        <h2 id="Callable"><a href="#Callable" class="headerlink" title="Callable"></a>Callable</h2><p>与<code>Runnable</code>相似，只是<code>Runnable</code>无返回值<br>A task that returns a result and may throw an exception. Implementors define a single method with no arguments called <code>call</code>.<br>The Callable interface is similar to Runnable, in that both are designed for classes whose instances are potentially executed by another thread. A Runnable, however, does not return a result and cannot throw a checked exception.</p>
<h2 id="Future"><a href="#Future" class="headerlink" title="Future"></a>Future</h2><p>异步保存结果<br>A Future represents the result of an asynchronous computation.<br>Methods are provided to check if the computation is complete, to wait for its completion, and to retrieve the result of the computation.<br>The result can only be retrieved using method <code>get</code> when the computation has completed, blocking if necessary until it is ready.<br>Cancellation is performed by the <code>cancel</code> method.<br>Additional methods are provided to determine if the task completed normally or was cancelled.<br>Once a computation has completed, the computation cannot be cancelled. If you would like to use a Future for the sake of cancellability but not provide a usable result, you can declare types of the form Future&lt;?&gt; and return null as a result of the underlying task.</p>
<h2 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h2><p>实现了在制定文件目录中的所有文件查找关键字的个数</p>
<ul>
<li>计数任务</li>
</ul>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">class</span> MatchCounter <span class="keyword">implements</span> Callable&lt;Integer&gt;&#123;</div><div class="line">	<span class="keyword">private</span> <span class="keyword">File</span> directory;</div><div class="line">	<span class="keyword">private</span> String keyWord;</div><div class="line">	<span class="keyword">private</span> <span class="keyword">int</span> <span class="keyword">count</span>;</div><div class="line">	</div><div class="line">	MatchCounter(<span class="keyword">File</span> directory, String keyWord)&#123;</div><div class="line">		<span class="keyword">this</span>.directory = directory;</div><div class="line">		<span class="keyword">this</span>.keyWord = keyWord;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="comment">//在文件中搜索关键字</span></div><div class="line">	<span class="keyword">public</span> <span class="keyword">boolean</span> search(<span class="keyword">File</span> <span class="keyword">file</span>)&#123;</div><div class="line">		<span class="keyword">try</span> &#123;</div><div class="line">			Scanner in = <span class="keyword">new</span> Scanner(<span class="keyword">file</span>);</div><div class="line">			<span class="keyword">boolean</span> found = <span class="keyword">false</span>;</div><div class="line">			<span class="keyword">while</span>(!found &amp;&amp; in.hasNextLine())&#123;</div><div class="line">				String line = in.nextLine();</div><div class="line">				<span class="keyword">if</span>(line.contains(keyWord))&#123;</div><div class="line">					found = <span class="keyword">true</span>;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">return</span> found;</div><div class="line">		&#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">		&#125;</div><div class="line">		</div><div class="line">		</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	@Override</div><div class="line">	<span class="keyword">public</span> Integer <span class="keyword">call</span>() <span class="keyword">throws</span> Exception &#123;</div><div class="line">		<span class="keyword">count</span> = <span class="number">0</span>;</div><div class="line">		<span class="keyword">File</span>[] files = directory.listFiles();</div><div class="line">		<span class="comment">//设置多个线程来访问文件，放在结果集中</span></div><div class="line">		List&lt;Future&lt;Integer&gt;&gt; results = <span class="keyword">new</span> ArrayList&lt;Future&lt;Integer&gt;&gt;();</div><div class="line">		</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">File</span> <span class="keyword">file</span> : files) &#123;</div><div class="line">			<span class="keyword">if</span>(<span class="keyword">file</span>.isDirectory())&#123;</div><div class="line">				<span class="comment">//是目录，开启一个计算任务</span></div><div class="line">				MatchCounter counter = <span class="keyword">new</span> MatchCounter(<span class="keyword">file</span>, keyWord);</div><div class="line">				<span class="comment">//可以存放多个Callable</span></div><div class="line">				FutureTask&lt;Integer&gt; <span class="keyword">task</span> = <span class="keyword">new</span> FutureTask&lt;Integer&gt;(counter);</div><div class="line">				<span class="comment">//新的任务开启并放在结果集中</span></div><div class="line">				results.add(<span class="keyword">task</span>);</div><div class="line">				Thread t = <span class="keyword">new</span> Thread(<span class="keyword">task</span>);</div><div class="line">				t.start();</div><div class="line">			&#125;<span class="keyword">else</span>&#123;</div><div class="line">				<span class="comment">//是文件，搜索关键字，计数</span></div><div class="line">				<span class="keyword">if</span>(search(<span class="keyword">file</span>))&#123;</div><div class="line">					<span class="keyword">count</span>++;</div><div class="line">				&#125;</div><div class="line">				</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		</div><div class="line">		<span class="comment">//对于结果集中的所有结果，计算所有的次数</span></div><div class="line">		<span class="keyword">for</span> (Future&lt;Integer&gt; future : results) &#123;</div><div class="line">			<span class="comment">//如果有些线程没有结果，就阻塞</span></div><div class="line">			<span class="keyword">count</span> += future.get();</div><div class="line">		&#125;</div><div class="line">		</div><div class="line">		<span class="keyword">return</span> <span class="keyword">count</span>;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>Main</li>
</ul>
<figure class="highlight haxe"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> void main(<span class="keyword">String</span>[] args) &#123;</div><div class="line">	Scanner <span class="keyword">in</span> = <span class="keyword">new</span> <span class="type">Scanner</span>(System.<span class="keyword">in</span>);</div><div class="line">	System.out.println(<span class="string">"Enter the directory..."</span>);</div><div class="line">	<span class="keyword">String</span> directory = <span class="keyword">in</span>.nextLine();</div><div class="line">	System.out.println(<span class="string">"Enter the keyword..."</span>);</div><div class="line">	<span class="keyword">String</span> keyword = <span class="keyword">in</span>.nextLine();</div><div class="line">	</div><div class="line">	MatchCounter counter = <span class="keyword">new</span> <span class="type">MatchCounter</span>(<span class="keyword">new</span> <span class="type">File</span>(directory), keyword);</div><div class="line">	FutureTask&lt;Integer&gt; task = <span class="keyword">new</span> <span class="type">FutureTask</span>&lt;Integer&gt;(counter);</div><div class="line">	Thread t = <span class="keyword">new</span> <span class="type">Thread</span>(task);</div><div class="line">	t.start();</div><div class="line">	</div><div class="line">	<span class="keyword">try</span> &#123;</div><div class="line">		System.out.println(task.<span class="keyword">get</span>() + <span class="string">" matching files."</span>);</div><div class="line">	&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</div><div class="line">		e.printStackTrace();</div><div class="line">	&#125; <span class="keyword">catch</span> (ExecutionException e) &#123;</div><div class="line">		e.printStackTrace();</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	</div><div class="line">&#125;</div></pre></td></tr></table></figure>


      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/">java</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-ConcurrentHashMap" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/25/ConcurrentHashMap/" class="article-date">
  	<time datetime="2016-03-25T05:43:29.000Z" itemprop="datePublished">2016-03-25</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/25/ConcurrentHashMap/">ConcurrentHashMap</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      

      <!-- Table of Contents -->
        
        <p>ConcurrentHashMap是Java 5中支持高并发、 高吞吐的HashMap。<br>它的关键技术是：锁分离技术。 它使用了多个锁来控制对hash表的不同部分进行修改。</p>
<h2 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h2><p>ConcurrentHashMap包含了两个静态内部类：</p>
<ul>
<li>HashEntry<br>用来封装映射表的键值对</li>
<li>Segment<br>用来充当锁的角色， 是一种可重入锁ReentrantLock 利用了锁分离技术来保护不同的segment</li>
</ul>
<p>ConcurrentHashMap中的Segment就管理若干个的HashTable， 每个HashTable由多个HashEntry组成。 每个Segment持有自己的锁， 只要修改操作发生在不同的Segment上， 就可以并发执行</p>
<h3 id="具体实现"><a href="#具体实现" class="headerlink" title="具体实现"></a>具体实现</h3><p>每个Segment对象守护整个散列表的若干个桶，每个桶由若干个HashEntry对象连接起来的</p>
<h3 id="ConcurrentHashMap是弱一致的"><a href="#ConcurrentHashMap是弱一致的" class="headerlink" title="ConcurrentHashMap是弱一致的"></a>ConcurrentHashMap是弱一致的</h3><p>ConcurrentHashMap进行操作时， put操作将一个元素加入到底层数据结构后，get可能在某段时间内还看不到这个元素。<br>ConcurrentHashMap的弱一致性主要是为了提升效率， 是一致性与效率之间的一种权衡。<br>要成为强一致性， 就得到处使用锁， 甚至是全局锁， 这就与Hashtable和同步的HashMap一样了</p>
<h2 id="深度好文"><a href="#深度好文" class="headerlink" title="深度好文"></a>深度好文</h2><p><a href="https://www.ibm.com/developerworks/cn/java/java-lo-concurrenthashmap/" target="_blank" rel="external">探索 ConcurrentHashMap 高并发性的实现机制</a></p>


      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/">java</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-Blocking-Queue" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/25/Blocking-Queue/" class="article-date">
  	<time datetime="2016-03-25T01:33:46.000Z" itemprop="datePublished">2016-03-25</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/25/Blocking-Queue/">Blocking Queue</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      

      <!-- Table of Contents -->
        
        <h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>A Queue that additionally supports operations that <strong>wait for the queue to become non-empty when retrieving an element</strong>, and <strong>wait for space to become available in the queue when storing an element</strong>.</p>
<p>BlockingQueue methods come in four forms, with different ways of handling operations that cannot be satisfied immediately, but may be satisfied at some point in the future: one throws an exception, the second returns a special value (either null or false, depending on the operation), the third blocks the current thread indefinitely until the operation can succeed, and the fourth blocks for only a given maximum time limit before giving up. These methods are summarized in the following table:</p>
<table>
<thead>
<tr>
<th style="text-align:center">Throws exception</th>
<th style="text-align:center">Special value</th>
<th style="text-align:center">Blocks</th>
<th style="text-align:center">Times out</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Insert</td>
<td style="text-align:center">add(e)</td>
<td style="text-align:center">offer(e)</td>
<td style="text-align:center">put(e)</td>
<td>offer(e, time, unit)</td>
</tr>
<tr>
<td style="text-align:center">Remove</td>
<td style="text-align:center">remove()</td>
<td style="text-align:center">poll()</td>
<td style="text-align:center">take()</td>
<td>poll(time, unit)</td>
</tr>
<tr>
<td style="text-align:center">Examine</td>
<td style="text-align:center">element()</td>
<td style="text-align:center">peek()</td>
<td style="text-align:center">not applicable</td>
<td>not applicable</td>
</tr>
</tbody>
</table>
<p>A BlockingQueue <strong>does not accept null elements</strong>. Implementations throw NullPointerException on attempts to add, put or offer a null. A null is used as a sentinel value to indicate failure of poll operations.</p>
<p>A BlockingQueue may be capacity bounded. At any given time it may have a remainingCapacity beyond which no additional elements can be put without blocking. A BlockingQueue without any intrinsic capacity constraints always reports a remaining capacity of Integer.MAX_VALUE.</p>
<p>BlockingQueue implementations are designed to be used primarily for <strong>producer-consumer</strong> queues, but additionally support the Collection interface. So, for example, it is possible to remove an arbitrary element from a queue using remove(x). However, such operations are in general not performed very efficiently, and are intended for only occasional use, such as when a queued message is cancelled.</p>
<p>BlockingQueue implementations are <strong>thread-safe</strong>. All queuing methods achieve their effects atomically using internal locks or other forms of concurrency control. However, the bulk Collection operations addAll, containsAll, retainAll and removeAll are not necessarily performed atomically unless specified otherwise in an implementation. So it is possible, for example, for addAll(c) to fail (throwing an exception) after adding only some of the elements in c.</p>
<p>A BlockingQueue does not intrinsically support any kind of “close” or “shutdown” operation to indicate that no more items will be added. The needs and usage of such features tend to be implementation-dependent. For example, a common tactic is for producers to insert special end-of-stream or poison objects, that are interpreted accordingly when taken by consumers.</p>
<p>Usage example, based on a typical producer-consumer scenario. Note that a BlockingQueue can safely be used with multiple producers and multiple consumers.</p>
<h2 id="Implementation"><a href="#Implementation" class="headerlink" title="Implementation"></a>Implementation</h2><ul>
<li>ArrayBlockingQueue</li>
<li>DelayQueue</li>
<li>LinkedBlockingQueue</li>
<li>PriorityBlockingQueue</li>
<li>SynchronousQueue</li>
</ul>
<h2 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h2><p>该例子实现了一个在所给目录的所有文件中找关键字的方法<br>其本质是生产者和消费者问题，一个向队列中插入文件，另一个在该队列中取出文件<br>这个队列的实现是利用<code>BlockingQueue</code>做到取出为空时阻塞，添加满时阻塞<br><figure class="highlight haxe"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> void main(<span class="keyword">String</span>[] args) &#123;</div><div class="line">	Scanner <span class="keyword">in</span> = <span class="keyword">new</span> <span class="type">Scanner</span>(System.<span class="keyword">in</span>);</div><div class="line">	System.out.println(<span class="string">"Enter the file directory..."</span>);</div><div class="line">	<span class="keyword">String</span> directory = <span class="keyword">in</span>.nextLine();</div><div class="line">	System.out.println(<span class="string">"Enter the keyword..."</span>);</div><div class="line">	<span class="keyword">String</span> keyword = <span class="keyword">in</span>.nextLine();</div><div class="line">	<span class="comment">//10个队列</span></div><div class="line">	BlockingQueue&lt;File&gt; queue = <span class="keyword">new</span> <span class="type">ArrayBlockingQueue</span>&lt;File&gt;(<span class="number">10</span>);</div><div class="line">	<span class="comment">//1个生产者</span></div><div class="line">	FileEnumrationTask task = <span class="keyword">new</span> <span class="type">FileEnumrationTask</span>(queue, <span class="keyword">new</span> <span class="type">File</span>(directory));</div><div class="line">	<span class="keyword">new</span> <span class="type">Thread</span>(task).start();</div><div class="line">	<span class="comment">//100个消费者</span></div><div class="line">	<span class="keyword">for</span> (int i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</div><div class="line">		<span class="keyword">new</span> <span class="type">Thread</span>(<span class="keyword">new</span> <span class="type">SearchTask</span>(queue, keyword)).start();</div><div class="line">		</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>文件遍历类是一个生产者，向队列中添加所给目录中的所有文件<br><figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">class</span> FileEnumrationTask <span class="keyword">implements</span> Runnable&#123;</div><div class="line"></div><div class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">File</span> DUMMY = <span class="keyword">new</span> <span class="keyword">File</span>(<span class="string">""</span>);</div><div class="line">	<span class="keyword">private</span> BlockingQueue&lt;<span class="keyword">File</span>&gt; queue;</div><div class="line">	<span class="keyword">private</span> <span class="keyword">File</span> startingDirectory;</div><div class="line">	</div><div class="line">	<span class="keyword">public</span> FileEnumrationTask(BlockingQueue&lt;<span class="keyword">File</span>&gt; queue, <span class="keyword">File</span> startingDirectory) &#123;</div><div class="line">		<span class="keyword">this</span>.queue = queue;</div><div class="line">		<span class="keyword">this</span>.startingDirectory = startingDirectory;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="keyword">public</span> <span class="keyword">void</span> enumerate(<span class="keyword">File</span> directory) <span class="keyword">throws</span> InterruptedException&#123;</div><div class="line">		<span class="keyword">File</span>[] files = directory.listFiles();</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">File</span> <span class="keyword">file</span> : files) &#123;</div><div class="line">			<span class="keyword">if</span>(<span class="keyword">file</span>.isDirectory())&#123;</div><div class="line">				enumerate(<span class="keyword">file</span>);</div><div class="line">			&#125;<span class="keyword">else</span>&#123;</div><div class="line">				queue.put(<span class="keyword">file</span>);</div><div class="line">			&#125;</div><div class="line">			</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	@Override</div><div class="line">	<span class="keyword">public</span> <span class="keyword">void</span> run() &#123;</div><div class="line">		<span class="keyword">try</span> &#123;</div><div class="line">			enumerate(startingDirectory);</div><div class="line">			queue.put(DUMMY);</div><div class="line">		&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">		&#125;</div><div class="line">		</div><div class="line">		</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>单词查找类是消费者，负责都队列中取出文件，然后在该文件中找关键字<br><figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">class</span> SearchTask <span class="keyword">implements</span> Runnable&#123;</div><div class="line">	<span class="keyword">private</span> BlockingQueue&lt;<span class="keyword">File</span>&gt; queue;</div><div class="line">	<span class="keyword">private</span> String keyword;</div><div class="line"></div><div class="line">	<span class="keyword">public</span> SearchTask(BlockingQueue&lt;<span class="keyword">File</span>&gt; queue, String keyword) &#123;</div><div class="line">		<span class="keyword">this</span>.queue = queue;</div><div class="line">		<span class="keyword">this</span>.keyword = keyword;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="keyword">public</span> <span class="keyword">void</span> search(<span class="keyword">File</span> <span class="keyword">file</span>)&#123;</div><div class="line">		<span class="keyword">try</span> &#123;</div><div class="line">			Scanner in = <span class="keyword">new</span> Scanner(<span class="keyword">file</span>);</div><div class="line">			<span class="keyword">int</span> lineNum = <span class="number">0</span>;</div><div class="line">			<span class="keyword">while</span>(in.hasNextLine())&#123;</div><div class="line">				lineNum++;</div><div class="line">				String line = in.nextLine();</div><div class="line">				<span class="keyword">if</span>(line.contains(keyword))&#123;</div><div class="line">					System.out.printf(<span class="string">"%s : %d : %s%n"</span>,<span class="keyword">file</span>.getPath(), lineNum, line);</div><div class="line">				&#125;</div><div class="line">				</div><div class="line">			&#125;</div><div class="line">		&#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">		&#125;</div><div class="line">		</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	@Override</div><div class="line">	<span class="keyword">public</span> <span class="keyword">void</span> run() &#123;</div><div class="line">		<span class="keyword">boolean</span> done = <span class="keyword">false</span>;</div><div class="line">		<span class="keyword">try</span> &#123;</div><div class="line">			<span class="keyword">while</span>(!done)&#123;</div><div class="line">				<span class="keyword">File</span> <span class="keyword">file</span> = queue.take();</div><div class="line">				<span class="keyword">if</span>(<span class="keyword">file</span> == FileEnumrationTask.DUMMY)&#123;</div><div class="line">					queue.put(<span class="keyword">file</span>);</div><div class="line">					done = <span class="keyword">true</span>;</div><div class="line">				&#125;<span class="keyword">else</span>&#123;</div><div class="line">					search(<span class="keyword">file</span>);</div><div class="line">				&#125;</div><div class="line">				</div><div class="line">			&#125;</div><div class="line">			</div><div class="line">		&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">		&#125;</div><div class="line">		</div><div class="line">		</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="Rerfences"><a href="#Rerfences" class="headerlink" title="Rerfences"></a>Rerfences</h2><p><a href="https://docs.oracle.com/javase/7/docs/api/java/util/concurrent/BlockingQueue.html" target="_blank" rel="external">https://docs.oracle.com/javase/7/docs/api/java/util/concurrent/BlockingQueue.html</a><br><a href="https://www.ibm.com/developerworks/cn/java/j-tiger06164/" target="_blank" rel="external">https://www.ibm.com/developerworks/cn/java/j-tiger06164/</a></p>


      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/">java</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/2/">&laquo; Prev</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/13/">13</a><a class="extend next" rel="next" href="/page/4/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2016 Du Yao
    	</div>
      	
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>